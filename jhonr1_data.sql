USE jhonr1_rugby;

INSERT INTO addresses (door_number, street_name, suburb, city, postal_code) VALUES 
('1', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('2', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('3', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('4', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('5', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('6', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('7', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('8', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('9', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('10', 'Forth street', 'North dunedin', 'Dunedin', 9016),
('1', 'union street', 'North dunedin', 'Dunedin', 9016),
('2', 'union street', 'North dunedin', 'Dunedin', 9016),
('3', 'union street', 'North dunedin', 'Dunedin', 9016),
('4', 'union street', 'North dunedin', 'Dunedin', 9016),
('5', 'union street', 'North dunedin', 'Dunedin', 9016),
('6', 'union street', 'North dunedin', 'Dunedin', 9016),
('7', 'union street', 'North dunedin', 'Dunedin', 9016),
('8', 'union street', 'North dunedin', 'Dunedin', 9016),
('9', 'union street', 'North dunedin', 'Dunedin', 9016),
('10', 'union street', 'North dunedin', 'Dunedin', 9016),
('1', 'clyde street', 'North dunedin', 'Dunedin', 9016),
('2', 'clyde street', 'North dunedin', 'Dunedin', 9016),
('3', 'clyde street', 'North dunedin', 'Dunedin', 9016),
('4', 'clyde street', 'North dunedin', 'Dunedin', 9016),
('5', 'clyde street', 'North dunedin', 'Dunedin', 9016),
('6', 'clyde street', 'North dunedin', 'Dunedin', 9016);

INSERT INTO persons (first_name, last_name, gender, dob, email) VALUES
('Arianna', 'Monahan', 'Male', '1980-09-27', 'Meaghan_Greenholt@sabryna.ca'),
('Pearl', 'Cummings', 'Male', '2005-08-16', 'Tianna_Mraz@katarina.tv'),
('Werner', 'Lehner', 'Male', '1979-01-10', 'Corbin@jules.me'),
('Sigmund', 'Prohaska', 'Male', '2003-08-17', 'Monroe_Doyle@aleen.tv'),
('Anton', 'Bernier', 'Male', '1981-08-27', 'Abdiel@dulce.io'),
('Louie', 'Cummings', 'Male', '2005-12-17', 'Fred@ashley.tv'),
('Maximillia', 'Bogan', 'Male', '1983-06-20', 'Simone.Zboncak@hoyt.com'),
('Ivah', 'Roob', 'Male', '20061230', 'Gabe@dulce.biz'),
('Ford', 'Smith', 'Male', '19761130', 'Margot@isom.info'),
('Thomas', 'Lang', 'Male', '2002-10-12', 'Bettie@dangelo.ca'),
('Ericka', 'Grimes', 'Female', '19840218', 'Eda.Cummerata@makayla.ca'),
('Mohamed', 'Littel', 'Male', '20040218', 'Brionna@nellie.ca'),
('Micheal', 'Schoen', 'Male', '1986-02-24', 'Maxime@dale.org'),
('Wilber', 'West', 'Male', '2004-02-17', 'Demario@jake.tv'),
('Elinor', 'Frami', 'Female', '19830318', 'Velda_Streich@jarrod.me'),
('Godfrey', 'Rohan', 'Male', '2006-12-09', 'Britney_Cummerata@rowena.me'),
('Elfrieda', 'Hickle', 'Female', '19860418', 'Richard.Jones@kyleigh.net'),
('Stephen', 'Crist', 'Male', '2003-05-31', 'Jany_Mante@adell.co.uk'),
('Murphy', 'Thompson', 'Male', '1984/01/27', 'Modesto@sanford.us'),
('Prudence', 'McLaughlin', 'Male', '2006-08-29', 'Devonte@carleton.net'),
('Freeda', 'Beahan', 'Female', '19850318', 'Krystina@juvenal.net'),
('Benjamin', 'Corwin', 'Male', '2003-02-01', 'Breanna@concepcion.info'),
('Lolita', 'Klein', 'Female', '1986-04-30', 'Elenora@cleveland.ca'),
('Dorris', 'Lubowitz', 'Male', '2007-07-24', 'Lennie_Ullrich@annetta.net'),
('Camryn', 'Mayer', 'Male', '1982-05-03', 'Giovanna.Wolff@alexandria.name'),
('Stephen', 'Shields', 'Male', '2007-04-15', 'Nikit.Rohan@vidal.io'),
('Elmo', 'Hand', 'Female', '1986-04-09', 'Elmo.Hand@flossie.name'),
('Fletcher', 'Larkin', 'Male', '2007-04-09', NULL),
('Joshuah', 'Barrows', 'Male', '1980-10-09','Joshuah.Barrows@yahoo.com'),
('Ashleigh', 'Durgan', 'Male', '2004-04-13', 'Amelie.Rau@leonor.us'),
('Robb', 'Dicki', 'Male', '1983-04-23', 'Robb.Dicki@leonor.us'),
('Jose', 'Lebsack', 'Male', '2004-08-23', NULL),
('Tony', 'Savarimuthu', 'Male', '1981-05-17', 'tony.savarimuthu@gmail.com'),
('Rohan', 'Savarimuthu', 'Male', '2008-12-25', 'rohsav123@gmail.com'),
('Esther', 'Rogahn', 'Male', '1984-01-25', 'Esther.Rogahn@gmail.com'),
('Casey', 'Bashirian', 'Male', '2005-12-25', NULL),
('Paul', 'crawford', 'Male', '1980-12-25', 'Paul.crawford@gmail.com'),
('Lonie', 'fidel', 'Male', '2006-10-05', NULL),
('Tania', 'Johns', 'Female', '1983-05-31', 'Libby.Schowalter@vernice.info'),
('Charlene', 'Amore', 'Male', '2007-06-01', 'Cierra@virgie.me'),
('Eloy', 'Bergstrom', 'Male', '2005-10-12', 'Rollin@mike.biz'),
('Carole', 'Walsh', 'Male', '1976-04-15', 'Carole.Walsh@vidal.io'),
('Simeon', 'Zboncak', 'Male', '2006-03-15', NULL),
('Prince', 'Dickens', 'Male', '2002-04-14', NULL),
('Mauricio', 'Leffler', 'Male', '1978-07-06', 'Jose_Graham@dustin.info'),
('Brenden', 'Witting', 'Male', '2004-04-28', 'Johanna@nicola.name'),
('Cora', 'Toy', 'Male', '2006-03-18', 'Josiah_Wolff@nicolas.net'),
('Rosella', 'Smitham', 'Female', '1975-08-15', 'Rosella_Smitham@sydnie.ca'),
('Darby', 'Barrows', 'Male', '1979-12-23', 'Darby_Barrows@austin.net'),
('Laury', 'Crona', 'Male', '1976-11-05', 'Laury_Crona@shaun.co.uk');

INSERT INTO person_address (person_id, address_id) VALUES
(1,1),
(3,2),
(5,3),
(7,4),
(9,5),
(11,6),
(13,7),
(15,8),
(17,9),
(19,10),
(21,11),
(23,12),
(25,13),
(27,14),
(29,15),
(31,16),
(33,17),
(35,18),
(37,19),
(39,20),
(42,21),
(45,23),
(48,24),
(49,25),
(50,26);

INSERT INTO telephones (phone_number, phone_type) VALUES
('021 123 4567','mobile'),
('022 123 4567','mobile'),
('023 123 4567','mobile'),
('024 123 4567','mobile'),
('025 123 4567','mobile'),
('026 123 4567','mobile'),
('027 123 4567','mobile'),
('028 123 4567','mobile'),
('029 123 4567','mobile'),
('030 123 4567','mobile'),
('031 123 4567','mobile'),
('032 123 4567','mobile'),
('033 123 4567','mobile'),
('034 123 4567','mobile'),
('035 123 4567','landline'),
('036 123 4567','landline'),
('037 123 4567','mobile'),
('038 123 4567','mobile'),
('039 123 4567','mobile'),
('040 123 4567','landline'),
('041 123 4567','mobile'),
('042 123 4567','mobile'),
('043 123 4567','mobile'),
('044 123 4567','landline'),
('045 123 4567','mobile'),
('046 123 4567','landline');

INSERT INTO person_telephone (person_id, telephone_id) VALUES
(1,1),
(3,2),
(5,3),
(7,4),
(9,5),
(11,6),
(13,7),
(15,8),
(17,9),
(19,10),
(21,11),
(23,12),
(25,13),
(27,14),
(29,15),
(31,16),
(33,17),
(35,18),
(37,19),
(39,20),
(42,21),
(45,23),
(48,24),
(49,25),
(50,26);

INSERT INTO schools (name, address, telephone) VALUES
('Otago Boys school', '2 Arthur St, Dunedin, 9016', '03-477 5527'),
('John McGlashan College', '2 Pilkington St, Maori Hill, Dunedin 9010', '03-467 6620'),
('high school of the kings', '270 Bay View Rd, Dunedin 9012', '03-455 7547'),
('Kavanagh College', '340 Rattray St, Dunedin, 9016', '03-477 3408'),
('Abbotsford School', '72 North Taieri Road, Dunedin', '03-4882642'),
('Taieri College', 'Green Street, Mosgiel', '03-4893823'),
('Kaikorai Valley College', 'Kaikorai Valley Road, Dunedin', '03-453 6035'),
('Balmacewen Intermediate', '44 Chapman Street, Dunedin', '03-466 7251'),
('Amana Christian School', '14 Gordon Road, Mosgiel', '03-489 2113');

INSERT INTO enrollments (school_id, person_id, student_year, start_date) VALUES
(1, 2, 9, '2019/02/07'),
(1, 4, 10, '2019/03/07'),
(1, 6, 9, '2019/02/08'),
(2, 8, 9, '2019/04/05'),
(2, 10, 11, '2019/06/07'),
(2, 12, 10, '2019/01/05'),
(3, 14, 10, '2019/02/06'),
(3, 16, 9, '2019/02/08'),
(3, 18, 11, '2019/03/07'),
(4, 20, 9, '2019/02/17'),
(4, 22, 10, '2019/02/27'),
(4, 24, 7, '2019/04/07'),
(5, 26, 7, '2019/02/11'),
(5, 28, 7, '2019/03/06'),
(5, 30, 10, '2019/02/01'),
(6, 32, 10, '2019/04/15'),
(6, 34, 6, '2019/02/18'),
(6, 36, 9, '2019/05/07'),
(7, 38, 8, '2019/02/27'),
(7, 40, 7, '2019/04/07'),
(7, 41, 8, '2019/05/17'),
(8, 43, 9, '2019/05/18'),
(8, 44, 11, '2019/10/25'),
(9, 46, 11, '2019/10/17'),
(9, 47, 8, '2019/07/08');

INSERT INTO coaches (person_id, start_date) VALUES
(42, '2019-02-07'),
(45, '2019-01-05'),
(48, '2019-04-01'),
(49, '2019-03-15'),
(50, '2019-03-26');

INSERT INTO teams (name, age, team_year, coach_id) VALUES
('All Blacks', 10, 2017, 1),
('Heartland', 11, 2017, 2),
('Black Ferns', 12, 2017, 3),
('Otago', 10, 2017, 4),
('Highlanders', 10, 2017, 5),
('All Blacks', 10, 2018, 1),
('Heartland', 11, 2018, 2),
('Black Ferns', 12, 2018, 3),
('Otago', 10, 2018, 4),
('Highlanders', 10, 2018, 5),
('All Blacks', 10, 2019, 1),
('Heartland', 11, 2019, 2),
('Black Ferns', 12, 2019, 3),
('Otago', 10, 2019, 4),
('Highlanders', 10, 2019, 5);

INSERT INTO players (enrollment_id, team_id) VALUES
(1,1),
(2,1),
(3,1),
(4,1),
(5,1),
(6,2),
(7,2),
(8,2),
(11,3),
(12,3),
(13,3),
(16,4),
(17,4),
(18,4),
(19,4),
(21,5),
(22,5),
(23,5),
(24,5),
(3,6),
(4,6),
(5,6),
(6,7),
(7,7),
(8,7),
(11,8),
(12,8),
(13,8),
(16,9),
(17,9),
(19,9),
(21,10),
(22,10),
(23,10),
(1,11),
(2,11),
(3,11),
(4,11),
(6,12),
(7,12),
(8,12),
(10,12),
(12,13),
(13,13),
(15,13),
(16,14),
(17,14),
(18,14),
(20,14),
(21,15),
(25,15);


INSERT INTO qualifications (name) VALUES
('Teenage Coaching Course'),
('Learning Rugby Course'),
('Playing Rugby Course'),
('Rugby Administration Course'),
('Rugby Experts Course');

INSERT INTO coach_qualification (qualification_id, coach_id) VALUES
(1, 1 ),
(2, 2 ),
(3, 3 ),
(4, 4 ),
(5, 5 );

INSERT INTO guardians VALUES
(1,2),
(3,4),
(5,6),
(7,8),
(9,10),
(11,12),
(13,14),
(15,16),
(17,18),
(19,20),
(21,22),
(23,24),
(25,26),
(27,28),
(29,30),
(31,32),
(33,34),
(35,36),
(37,38),
(39,40),
(39,41),
(42,43),
(42,44),
(45,46),
(45,47);


DROP FUNCTION IF EXISTS teamsize;
DELIMITER //
CREATE FUNCTION teamsize(tName VARCHAR(25), tYear YEAR)
returns int
BEGIN
SET @tSize = (SELECT COUNT(*) FROM players WHERE team_id IN (SELECT id FROM teams WHERE name = tName AND tYear = team_year) );
RETURN @tSize;
END; //
DELIMITER ;

SELECT teamsize("All Blacks", '2019');

DROP VIEW IF EXISTS phonelist;

CREATE VIEW phonelist AS SELECT DISTINCT p.id AS Person_id, p.first_name AS Student, t.name AS Team, per.first_name AS Caregiver, tel.phone_number AS Phone_number FROM ((((((teams t JOIN players pl ON t.id = pl.team_id) JOIN enrollments en ON pl.enrollment_id = en.id) JOIN persons p ON en.person_id = p.id) JOIN guardians g ON p.id = g.dependant_id) JOIN persons per ON g.caregiver_id = per.id) JOIN person_telephone pt ON pt.person_id = per.id) JOIN telephones tel ON pt.telephone_id = tel.id ORDER BY p.id;

